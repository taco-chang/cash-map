{"version":3,"sources":["components/editor/TypeDropdown.tsx","components/EditRecord.tsx"],"names":["TypeDropdown","children","value","onChange","intl","useIntl","className","target","messages","INCOME","EXPENSES","DEPOSIT","EditForm","data","isAppended","record","RecordModel","useState","window","innerWidth","isXs","asXs","isLoading","useLoading","isSizeChanged","JSON","stringify","getJSON","initValue","Loading","dispatch","useRecord","Message","useMessage","doCancel","useCallback","reset","history","back","useEffect","$","on","off","doStopSubmit","e","preventDefault","stopPropagation","type","content","handler","btn","BTN","CONFIRM","doCreate","show","callbackFn","action","params","fail","message","success","doUpdate","useEvents","onSubmit","tagName","id","align","width","md","desc","def","status","mapTurnOn","ACTUAL","EXPECTED","cycle","CYCLE_ONCE","CYCLE_DAY","CYCLE_MONTH","CYCLE_YEAR","amount","amountStr","margin","t","onClick","disabled","EditRecord","match","uid","store"],"mappings":"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","file":"static/js/0.603cfa55.chunk.js","sourcesContent":["import React, { FC, ReactNode } from 'react';\r\nimport { useIntl } from 'react-intl';\r\n\r\n\r\n// TODO: Types\r\ninterface IProps {\r\n  children?: ReactNode;\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n}\r\n\r\nconst TypeDropdown: FC<IProps> = ({ children, value = 'income', onChange = () => {}}) => {\r\n  const intl = useIntl();\r\n\r\n  return (\r\n    <select className=\"form-control\" value={ value } onChange={\r\n      ({ target }) => onChange(target.value)\r\n    }>\r\n      { children }\r\n      <option value=\"income\">{ intl.messages.INCOME }</option>\r\n      <option value=\"expenses\">{ intl.messages.EXPENSES }</option>\r\n      <option value=\"deposit\">{ intl.messages.DEPOSIT }</option>\r\n    </select>\r\n  );\r\n};\r\n\r\nexport default TypeDropdown;\r\n","import React, { FC, Dispatch, SetStateAction, FormEvent, useState, useEffect, useCallback } from 'react';\r\n// import DatePicker from 'react-datepicker';\r\nimport { FormattedMessage as Fmsg, useIntl } from 'react-intl';\r\nimport { match } from 'react-router-dom';\r\n\r\nimport { BTN, useMessage } from '../services/message';\r\nimport { useLoading } from '../services/loading';\r\nimport { RecordModel, IRecordData, useRecord } from '../services/store/record';\r\nimport { BsContainer, BsRow, BsCol } from './grid';\r\nimport TypeDropdown from './editor/TypeDropdown';\r\n\r\nimport 'react-datepicker/dist/react-datepicker.css';\r\n\r\n\r\n// TODO: Types\r\ninterface IEventInput {\r\n  isXs: boolean;\r\n  asXs: Dispatch<SetStateAction<boolean>>;\r\n  record: RecordModel;\r\n}\r\n\r\ninterface IEventOutput {\r\n  doStopSubmit: (e: FormEvent) => void;\r\n  doCancel: () => void;\r\n  doCreate: () => void;\r\n  doUpdate: () => void;\r\n}\r\n\r\n\r\n// TODO: Events\r\nconst useEvents = ({ isXs, asXs, record }: IEventInput): IEventOutput => {\r\n  const isSizeChanged = isXs === (window.innerWidth < 576);\r\n  const [ initValue ] = useState(JSON.stringify(record.getJSON()));\r\n  const { isLoading, Loading } = useLoading();\r\n  const { dispatch } = useRecord();\r\n  const { Message } = useMessage();\r\n\r\n  const doCancel = useCallback(() => {\r\n    record.reset();\r\n    window.history.back();\r\n  }, [ record ]);\r\n\r\n  useEffect(() => {\r\n    $(window).on('resize', () => asXs(window.innerWidth < 576));\r\n\r\n    return () => { $(window).off('resize') };\r\n  }, [ isSizeChanged, asXs ]);\r\n\r\n  return {\r\n    doStopSubmit: useCallback((e: FormEvent) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }, []),\r\n\r\n    doCancel: useCallback(() => initValue === JSON.stringify(record.getJSON()) ? doCancel() : Message({\r\n      type: 'CONFIRM',\r\n      content: 'MSG_MODIFIED_CHECK',\r\n      handler: btn => BTN.CONFIRM === btn ? doCancel() : null\r\n    }), [ Message, initValue, record, doCancel ]),\r\n\r\n    doCreate: useCallback(() => isLoading ? null : Loading({\r\n      show: true,\r\n      callbackFn: () => dispatch({\r\n        action: 'CREATE',\r\n        params: record.getJSON(),\r\n        fail: (e: Error) => Loading({\r\n          show: false,\r\n          callbackFn: () => Message({ type: 'DANGER', content: e.message })\r\n        }),\r\n        success: () => Loading({\r\n          show: false,\r\n          callbackFn: () => {\r\n            window.history.back();\r\n            Message({ type: 'INFO', content: 'MSG_SAVE_SUCCESS' });\r\n          }\r\n        })\r\n      })\r\n    }), [ Message, Loading, isLoading, record, dispatch ]),\r\n\r\n    doUpdate: useCallback(() => isLoading ? null : Loading({\r\n      show: true,\r\n      callbackFn: () => dispatch({\r\n        action: 'UPDATE',\r\n        params: record.getJSON(),\r\n        fail: (e: Error) => Loading({\r\n          show: false,\r\n          callbackFn: () => Message({\r\n            type: 'DANGER',\r\n            content: e.message\r\n          })\r\n        }),\r\n        success: () => Loading({\r\n          show: false,\r\n          callbackFn: () => {\r\n            window.history.back();\r\n            Message({ type: 'INFO', content: 'MSG_SAVE_SUCCESS' });\r\n          }\r\n        })\r\n      })\r\n    }), [ Message, Loading, isLoading, record, dispatch ])\r\n  };\r\n};\r\n\r\n// TODO: Components\r\nconst EditForm: FC<{ data: IRecordData; isAppended: boolean; }> = ({ data, isAppended }) => {\r\n  const intl = useIntl();\r\n  const record = new RecordModel(data);\r\n  const [ isXs, asXs ] = useState(window.innerWidth < 576);\r\n  const { isLoading } = useLoading();\r\n  const { doStopSubmit, doCancel, doCreate, doUpdate } = useEvents({ isXs, asXs, record });\r\n\r\n  return (\r\n    <form onSubmit={ doStopSubmit }>\r\n      <h4 className=\"page-title\">\r\n        <i className={ `mr-2 fa fa-${ isAppended ? 'plus' : 'pencil' }` } />\r\n        <Fmsg tagName=\"strong\" id={ isAppended ? 'APPEND_RECORD' : 'UPDATE_RECORD' } />\r\n      </h4>\r\n\r\n      <BsContainer>\r\n        <BsRow align=\"center\">\r\n          <BsCol className=\"form-group\" width={{ md: 8 }}>\r\n            <Fmsg tagName=\"label\" id=\"RECORD_DESC\" />\r\n\r\n            <input type=\"text\" className=\"form-control\" value={ record.desc } onChange={\r\n              ({ target }) => record.desc = target.value\r\n            } />\r\n          </BsCol>\r\n        </BsRow>\r\n\r\n        <BsRow align=\"center\">\r\n          <BsCol className=\"form-group\" width={{ def: 6, md: 4 }}>\r\n            <Fmsg tagName=\"label\" id=\"RECORD_TYPE\" />\r\n            <TypeDropdown value={ record.type } onChange={ value => record.type = value } />\r\n          </BsCol>\r\n          \r\n          <BsCol className=\"form-group\" width={{ def: 6, md: 4 }}>\r\n            <Fmsg tagName=\"label\" id=\"RECORD_STATUS\" />\r\n\r\n            <select className=\"form-control\" value={ record.status } onChange={({ target }) => {\r\n              record.status    = target.value;\r\n              record.mapTurnOn = isAppended && 'expected' === target.value ? false : record.mapTurnOn;\r\n            }}>\r\n              <option value=\"actual\">{ intl.messages.ACTUAL }</option>\r\n              <option value=\"expected\">{ intl.messages.EXPECTED }</option>\r\n            </select>\r\n          </BsCol>\r\n        </BsRow>\r\n          \r\n        <BsRow align=\"center\">\r\n          <BsCol className=\"form-group\" width={{ def: 6, md: 4 }}>\r\n            <Fmsg tagName=\"label\" id=\"AMOUNT_CYCLE\" />\r\n\r\n            <select className=\"form-control\" value={ record.cycle } onChange={\r\n              ({ target }) => record.cycle = target.value\r\n            }>\r\n              <option value=\"once\">{ intl.messages.CYCLE_ONCE }</option>\r\n              <option value=\"day\">{ intl.messages.CYCLE_DAY }</option>\r\n              <option value=\"month\">{ intl.messages.CYCLE_MONTH }</option>\r\n              <option value=\"year\">{ intl.messages.CYCLE_YEAR }</option>\r\n            </select>\r\n          </BsCol>\r\n\r\n          <BsCol className=\"form-group\" width={{ def: 6, md: 4 }}>\r\n            {/* { 'once' !== record.cycle ? null : [\r\n              <Fmsg key=\"label\" tagName=\"label\" id=\"VALID_YM\" />,\r\n\r\n              <DatePicker key=\"dpicker\" showMonthYearPicker withPortal={ isXs } className=\"form-control\" dateFormat=\"yyyy/MM\"\r\n                selected={ record.vdateFm } onChange={(val) => record.vdateFm = val} />\r\n            ] } */}\r\n          </BsCol>\r\n        </BsRow>\r\n          \r\n        <BsRow align=\"center\">\r\n          <BsCol className=\"form-group\" width={{ md: 8 }}>\r\n            <Fmsg tagName=\"label\" id=\"AMOUNT\" />\r\n\r\n            <input type=\"number\" className=\"form-control text-right\" value={ record.amount } onChange={\r\n              ({ target }) => record.amountStr = target.value\r\n            } />\r\n          </BsCol>\r\n        </BsRow>\r\n\r\n        <BsRow margin={{ t: 5 }}>\r\n          <BsCol className=\"text-right\">\r\n            <button type=\"button\" className=\"btn btn-secondary mr-2\" onClick={ doCancel }>\r\n              <i className=\"fa fa-ban mr-2\" />\r\n              <Fmsg id=\"CANCEL\" />\r\n            </button>\r\n\r\n            <button type=\"submit\" className=\"btn btn-primary\" disabled={ isLoading } onClick={ isAppended ? doCreate : doUpdate }>\r\n              <i className={ `fa fa-${ isAppended ? 'plus' : 'download' } mr-2` } />\r\n              <Fmsg id={ isAppended ? 'ADD' : 'SAVE' } />\r\n            </button>\r\n          </BsCol>\r\n        </BsRow>\r\n      </BsContainer>\r\n    </form>\r\n  );\r\n};\r\n\r\nconst EditRecord: FC<{ match: match<{ uid: string; }>; }> = ({ match: { params: { uid = '' } }}) => {\r\n  const { store: { target: { data } }, dispatch } = useRecord();\r\n\r\n  useEffect(() => {\r\n    if (uid) dispatch({ action: 'FIND', params: { uid }});\r\n  }, [ uid, dispatch ]);\r\n\r\n  return !data && uid ? null : (\r\n    <EditForm isAppended={ !uid } data={ data || {} } />\r\n  );\r\n};\r\n\r\nexport default EditRecord;\r\n"],"sourceRoot":""}